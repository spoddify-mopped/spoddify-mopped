# Contributing

Contributing and pull requests are very welcome.

This project is mainly written in TypeScript and uses Express.js for the backend and React for the frontend.
There is also some code for ESP32 boards written in C++ and a python script to connect the ESP32 boards via BLE with the Node.js backend.

## Requirements

- node v16.14.0
- yarn

There is a `.nvmrc` in the root of this project. If you use nvm you can easily run `nvm use` to configure the correct node version.

## Setup

Remove any globally installed versions of `spoddify-mopped` you may have installed on your development machine:

```bash
npm uninstall -g spoddify-mopped
```

Install yarn with:

```bash
npm i -g yarn
```

Install all node dependencies for this project:

```bash
yarn install
```

Your local setup is ready.

## Developing

Firstly make sure you have correctly configured the `config.json` to start the application. You can follow [this guide]().

You can either run the backend and frontend together or individually.

To start both:

```bash
yarn start
```

To only start the backend:

```bash
yarn backend start
```

To only start the frontend:

```bash
yarn frontend start
```

## Linting and formatting

There are pre-commit hooks for linting and formatting which will be installed on `yarn install`.

You can also run them by yourself:

```bash
yarn lint
```

and

```bash
yarn format
```

To individually lint and format each package:

```bash
yarn <backend|frontend> lint
```

and

```bash
yarn <backend|frontend> format
```

## Building

Build the project:

```
yarn build
```

This will build both packages. The frontend build will be outputted to the `public` directory of the backend.
And the backend to the `dist` directory.

To locally check if your build was successful, run:

```bash
yarn pack
```

in the directory of the [backend - packages/backend](packages/backend) and install the tarball with:

```bash
npm install -g <PATH_TO_TARBALL>
```

Make sure to remove the global installed package for further development.

## Tests

There are some unit and integration tests for the backend:

```bash
yarn backend test
```

If you want a coverage report, you can use:

```bash
yarn backend test:coverage
```

Make sure to run the tests before creating a pull request.

## Swagger documentation

There is a **non-autogenerated** `swagger.json` in the directory of the [backend - packages/backend](packages/backend).
Make sure to extend this when you are adding new api routes.
